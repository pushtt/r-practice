group_by(channel) %>%
nest() %>%
mutate(
model = map(data, channel_model),
resid = map2(data, model, add_residuals),
pred = map2(data, model, add_predictions)
) %>%
unnest(pred)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour =) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5))
library(modelr)
channel_model <- function(df) {
lm(sales ~ budget, data = df)
}
prediction <- advertising_tided %>%
group_by(channel) %>%
nest() %>%
mutate(
model = map(data, channel_model),
resid = map2(data, model, add_residuals),
pred = map2(data, model, add_predictions)
) %>%
unnest(pred)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour =) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5))
prediction <- advertising_tided %>%
group_by(channel) %>%
nest() %>%
mutate(
model = map(data, channel_model),
resid = map2(data, model, add_residuals),
pred = map2(data, model, add_predictions)
) %>%
unnest(pred)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour =) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5))
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5))
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format())
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format())
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
income <- read_csv("~/Documents/GitHub/myr/ISLR/ISLR-Auto/Income1.csv")
income
income <- income %>%
select(-X1)
income <- income %>%
select(-X1)
income <- read_csv("~/Documents/GitHub/myr/ISLR/ISLR-Auto/Income1.csv")
income <- income %>%
select(-X1)
income
income %>%
ggplot(aes(Education, Income)) +
geom_point(colour = "red")
income %>%
ggplot(aes(Education, Income)) +
geom_point(colour = "red") +
geom_smooth(stat = "lm")
income %>%
ggplot(aes(Education, Income)) +
geom_point(colour = "red") +
geom_smooth(stat = "lm")
income %>%
ggplot(aes(Education, Income)) +
geom_point(colour = "red") +
geom_smooth(method = "lm")
income %>%
ggplot(aes(Education, Income)) +
geom_point(colour = "red") +
geom_smooth(method = "lm", se = FALSE)
income %>%
ggplot(aes(Education, Income)) +
geom_point(colour = "red") +
geom_smooth()
income %>%
ggplot(aes(Education, Income)) +
geom_point(colour = "red") +
geom_smooth(se = FALSE)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_smooth(method = "lm") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, colour = "red") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_line(data = prediction, aes(x = sales, y = pred, colour = "blue", opacity = 0.3))
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_line(data = prediction, aes(x = sales, y = pred, colour = "blue", opacity = 0.3)) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_line(data = prediction, aes(x = preid, y = sales, colour = "blue", opacity = 0.3)) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_line(data = prediction, aes(x = pred, y = sales, colour = "blue", opacity = 0.3)) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_point(data = prediction, aes(x = pred, y = sales, colour = "blue", opacity = 0.3)) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(x = budget, y = pred, colour = "blue", opacity = 0.3)) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred, colour = "blue", opacity = 0.3)) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred, opacity = 0.3)) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred, colour = "blue", opacity = 0.3)) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred), opacity = 0.3, colour = "blkue") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred), opacity = 0.3, colour = "blue") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred), opacity = 0.1, colour = "blue") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred), alpha = 0.1, colour = "blue") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred), alpha = 0.3, colour = "blue") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
geom_segment(data = prediction, aes(xend = budget, yend = pred), alpha = 0.5, colour = "blue") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_line(data = prediction, aes(y = pred), colour = "red") +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
advertising_tided %>%
ggplot(aes(budget, sales)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ channel, scales = "free") +
scale_y_continuous(breaks = seq(5, 25, 5)) +
scale_x_continuous(labels = scales::dollar_format()) +
labs(
x = "Budget (thousounds of dollar)",
y = "Sales (thousands of units)",
title = "Sales in 200 different markets with budget spending on media"
)
income %>%
ggplot(aes(Education, Income)) +
geom_point(colour = "red") +
geom_smooth(se = FALSE)
names(income) <- set_names(rattle::normVarNames(names(income)))
income %>%
ggplot(aes(education, incom)) +
geom_point(colour = "red") +
geom_smooth(se = FALSE)
income %>%
ggplot(aes(education, income)) +
geom_point(colour = "red") +
geom_smooth(se = FALSE)
loess(income ~ education, data = income)
mod <- loess(income ~ education, data = income)
income %>%
add_predictions(mod)
income <- income %>%
add_predictions(mod)
income %>%
ggplot(aes(education, income)) +
geom_point(colour = "red") +
geom_segment(aes(xend = education, yend = income))
income %>%
ggplot(aes(education, income)) +
geom_point(colour = "red") +
geom_segment(aes(xend = education, yend = income)) +
geom_smooth(se = FALSE)
income
income %>%
ggplot(aes(education, income)) +
geom_point(colour = "red") +
geom_segment(aes(xend = education, yend = pred)) +
geom_smooth(se = FALSE)
library(plotly)
income2 <- read_csv("~/Documents/GitHub/myr/ISLR/ISLR-Auto/Income2.csv")
income2 <- income2 %>%
select(-X1)
income2 <- income2 %>%
select(-X1)
income2
names(income2) <- set_names(rattle::normVarNames(names(income2)))
income2
income2 %>% plot_ly(education, seniority, income)
income2 %>% plot_ly(~education, ~seniority, ~income)
income2 %>% plot_ly(x = ~education,
y = ~seniority,
z = ~income)
library(mgcv)
detach(mgcv)
search()
detach(package::mgcv)
detach(package::mgcv, unload = TREU)
detach(package::mgcv, unload = TRUE)
mod2 <- lm(income ~ education + seniority, data = income2)
mod2 <- lm(income ~ education + seniority, data = income2)
mod2 <- lm(income ~ education + seniority, data = income2)
summary(mod2)
imcome2 %>%
add_predictions(mod2)
income2 %>%
add_predictions(mod2)
income2 %>%
add_predictions(mod2) %>%
persp(education, seniority, income)
income2
plot_ly() %>% add_surface(x = ~disps, y = ~wts, z = ~m)
m <- lm(mpg ~ wt + disp, data = mtcars)
# predict over sensible grid of values
wts <- unique(mtcars$wt)
disps <- unique(mtcars$disp)
grid <- with(mtcars, expand.grid(wts, disps))
d <- setNames(data.frame(grid), c("wt", "disp"))
vals <- predict(m, newdata = d)
# form matrix and give to plotly
m <- matrix(vals, nrow = length(unique(d$wt)), ncol = length(unique(d$disp)))
library(plotly)
plot_ly() %>% add_surface(x = ~disps, y = ~wts, z = ~m)
income2 %>%
add_predictions(mod2) %>%
plot_y(
x = ~ education,
y = ~ seniority,
z = ~ income
)
income2 %>%
add_predictions(mod2) %>%
plot_ly(
x = ~ education,
y = ~ seniority,
z = ~ income
)
library(plotly)
income2 %>%
add_predictions(mod2) %>%
plot_ly(
x = ~ education,
y = ~ seniority,
z = ~ income
)
income2 %>%
add_predictions(mod2) %>%
plot_ly(
x = ~ education,
y = ~ seniority,
z = ~ income
) %>%
add_surface()
income2 %>%
add_predictions(mod2) %>%
plot_ly(
x = ~ education,
y = ~ seniority,
z = ~ income
) %>%
add_surface(x = ~ education,
y = ~ seniority,
z = ~ income)
income2 %>%
add_predictions(mod2) %>%
plot_ly(
x = ~ education,
y = ~ seniority,
z = ~ income
)
