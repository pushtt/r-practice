---
title: "Classification"
output: html_notebook
editor_options: 
  chunk_output_type: console
---

*Basic question*: Which one is what?


```{r}
library(tidyverse)
theme_set(theme_light())
```

```{r}
default <- ISLR::Default %>% as_tibble()

default %>% 
  ggplot(aes(balance, income, colour = default)) +
  geom_point(alpha = 0.3, size = 5, shape = 1) +
  scale_x_continuous(breaks = seq(0, 2500, 500))


default %>% 
  gather(type, value, c(balance, income)) %>% 
  ggplot(aes(default, value, fill = default)) +
  geom_boxplot() + 
  facet_wrap(~ type, scales = "free")
 

test <- default %>% 
  mutate(default = ifelse(default == "Yes", 1, 0),
         student = ifelse(student == "Yes", 1, 0))

```

Let's fix in logistic regression model

```{r single variable}
library(modelr)
mod1 <- lm(default ~ balance, data = test)
mod2 <- glm(default ~ balance, data = test, family = binomial)
mod3 <- glm(default ~ student, data = test, family = binomial)
mod4 <- glm(default ~ balance + income + student , data = test, family = binomial)

pred <- test %>% 
  gather_predictions(linear = mod1, 
                     logistic_balance = mod2, 
                     logistic_student = mod3, 
                     logstic_multiple = mod4,
                     .pred = "prob",
                      type = "response") 

pred %>% 
  ggplot(aes(balance, prob, colour = model)) +
  geom_hline(yintercept = c(0,1), linetype = 2) +
  geom_line() + 
  facet_wrap(~ model)
```

```{r}
pred %>% 
  filter(str_detect(model, "multiple")) %>%
  ggplot(aes(balance, prob, colour = ifelse(student == 1, "Yes", "No"))) +
  geom_line()

pred %>% 
  filter(str_detect(model, "multiple")) %>%
  ggplot(aes(ifelse(student == 1, "Yes", "No"), balance, fill = ifelse(student == 1, "Yes", "No"))) +
  geom_boxplot()

```


